# Learning Management Appï¼ˆå­¦ç¿’ç®¡ç†ã‚¢ãƒ—ãƒªï¼‰

å­ä¾›2äººã®å­¦ç¿’çŠ¶æ³ã‚’ **æ¯æ—¥è¨˜éŒ²ã—ã€é€±å˜ä½ã§æŒ¯ã‚Šè¿”ã‚‹ãŸã‚ã®å­¦ç¿’ç®¡ç†ã‚¢ãƒ—ãƒª** ã§ã™ã€‚  
å®¶åº­å†…ã§å®Ÿéš›ã«å›°ã£ã¦ã„ãŸèª²é¡Œã‚’è§£æ±ºã™ã‚‹ç›®çš„ã§é–‹ç™ºã—ã¦ã„ã¾ã™ã€‚

---

## ğŸ¯ èƒŒæ™¯ãƒ»ç›®çš„ï¼ˆWhyï¼‰

ç¾åœ¨ã€å­ä¾›2äººã®å‹‰å¼·ã‚’æ—¥ã€…ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ã¾ã™ãŒã€ä»¥ä¸‹ã®èª²é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚

- æ—¥ã€…ã®å­¦ç¿’å†…å®¹ã¯ç¢ºèªã—ã¦ã„ã‚‹ãŒã€**å±¥æ­´ã¨ã—ã¦æ®‹ã‚‰ãªã„**
- **1é€±é–“å˜ä½ã§ã®æŒ¯ã‚Šè¿”ã‚Šãƒ»æ¯”è¼ƒãŒã§ããªã„**
- å‹‰å¼·æ™‚é–“ã‚„ç§‘ç›®ã®åã‚ŠãŒ **è¦‹ãˆã‚‹åŒ–ã•ã‚Œã¦ã„ãªã„**

ãã“ã§ã€

> **ã€Œæ¯æ—¥1åˆ†ã§è¨˜éŒ²ã§ãã€é€±å˜ä½ã§å­¦ç¿’çŠ¶æ³ã‚’æŒ¯ã‚Šè¿”ã‚Œã‚‹ã€**

å­¦ç¿’ç®¡ç†ã‚¢ãƒ—ãƒªã‚’è‡ªåˆ†ç”¨ã«ä½œæˆã—ã€å®Ÿéš›ã«é‹ç”¨ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚

---

## ğŸ§© æ¦‚è¦ï¼ˆWhatï¼‰

- å­ä¾›ã”ã¨ã®å­¦ç¿’è¨˜éŒ²ã‚’ç®¡ç†
- å­¦ç¿’å†…å®¹ï¼ˆç§‘ç›®ãƒ»æ™‚é–“ãƒ»ãƒ¡ãƒ¢ï¼‰ã‚’æ—¥å˜ä½ã§è¨˜éŒ²
- é€±å˜ä½ã§å­¦ç¿’æ™‚é–“ã‚’é›†è¨ˆãƒ»å¯è¦–åŒ–
- å®Ÿéš›ã«å®¶åº­ã§åˆ©ç”¨ãƒ»ç¶™ç¶šæ”¹å–„ã‚’å‰æã¨ã—ãŸè¨­è¨ˆ

---

## ğŸ–¥ï¸ ç”»é¢ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆMVPï¼‰

- **å­¦ç¿’è¨˜éŒ²å…¥åŠ›ç”»é¢**  
  ä»Šæ—¥ã®å­¦ç¿’å†…å®¹ã‚’ç°¡å˜ã«å…¥åŠ›
- **é€±é–“ä¸€è¦§ç”»é¢**  
  1é€±é–“åˆ†ã®å­¦ç¿’å±¥æ­´ã‚’ä¸€è¦§è¡¨ç¤º
- **é€±é–“ã‚µãƒãƒªãƒ¼ç”»é¢**  
  ç§‘ç›®åˆ¥ãƒ»åˆè¨ˆå­¦ç¿’æ™‚é–“ã®å¯è¦–åŒ–

---

## ğŸ›  æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ï¼ˆTech Stackï¼‰

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- Next.js
- TypeScript

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- Go
- REST API

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- PostgreSQLï¼ˆäºˆå®šï¼‰

### ãã®ä»–
- Dockerï¼ˆäºˆå®šï¼‰
- GitHub Actionsï¼ˆCIäºˆå®šï¼‰

---

## ğŸ— ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

Next.js (TypeScript)
â†“
Go API
â†“
Database

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’åˆ†é›¢ã—ã€  
å°†æ¥çš„ãªæ©Ÿèƒ½è¿½åŠ ãƒ»ã‚¹ã‚±ãƒ¼ãƒ«ã‚’æ„è­˜ã—ãŸæ§‹æˆã«ã—ã¦ã„ã¾ã™ã€‚

---

## ğŸš€ ä»Šå¾Œã®äºˆå®šï¼ˆRoadmapï¼‰

- [ ] å­¦ç¿’è¨˜éŒ²CRUD API
- [ ] é€±é–“é›†è¨ˆAPI
- [ ] ãƒ•ãƒ­ãƒ³ãƒˆç”»é¢å®Ÿè£…
- [ ] å®Ÿé‹ç”¨ãƒ»æ”¹å–„
- [ ] ã‚°ãƒ©ãƒ•è¡¨ç¤ºãƒ»åˆ†ææ©Ÿèƒ½ï¼ˆæ¤œè¨ï¼‰

---

## ğŸ‘¤ é–‹ç™ºè€…ãƒ¡ãƒ¢

- å®Ÿéš›ã«å®¶åº­ã§ä½¿ç”¨ã—ãªãŒã‚‰æ”¹å–„äºˆå®š
- ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªç›®çš„ã ã‘ã§ãªãã€**ç¶™ç¶šé‹ç”¨ã‚’å‰æ**

---

## âœ… APIæ¤œè¨¼ï¼ˆMVPï¼‰

### Migration

```bash
psql "$DATABASE_URL" -f migrations/001_create_users.sql
psql "$DATABASE_URL" -f migrations/002_create_children.sql
psql "$DATABASE_URL" -f migrations/003_create_tasks.sql
psql "$DATABASE_URL" -f migrations/004_create_study_logs.sql
psql "$DATABASE_URL" -f migrations/005_add_task_sort_order.sql
psql "$DATABASE_URL" -f migrations/006_make_password_hash_nullable.sql
psql "$DATABASE_URL" -f migrations/007_add_user_profile.sql
```

### curlä¾‹ï¼ˆlogin â†’ token â†’ childrenï¼‰

```bash
# signup
curl -s -X POST http://localhost:3000/api/v1/auth/signup \\
  -H "Content-Type: application/json" \\
  -d '{"email":"parent@example.com","password":"secret123"}'

# login
TOKEN=$(curl -s -X POST http://localhost:3000/api/v1/auth/login \\
  -H "Content-Type: application/json" \\
  -d '{"email":"parent@example.com","password":"secret123"}' | jq -r .token)

# create child
curl -s -X POST http://localhost:3000/api/v1/children \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "Content-Type: application/json" \\
  -d '{"name":"Taro","grade":"1"}'

# list children
curl -s -X GET http://localhost:3000/api/v1/children \\
  -H "Authorization: Bearer $TOKEN"
```

### curlä¾‹ï¼ˆtask ä½œæˆ â†’ ä¸€è¦§ â†’ æ›´æ–°ï¼‰

```bash
# create task
curl -s -X POST http://localhost:3000/api/v1/children/$CHILD_ID/tasks \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "Content-Type: application/json" \\
  -d '{"name":"Math Drill","subject":"math","default_minutes":20,"days_mask":62}'

# list tasks (archived=false default)
curl -s -X GET "http://localhost:3000/api/v1/children/$CHILD_ID/tasks" \\
  -H "Authorization: Bearer $TOKEN"

# update task (archive)
curl -s -X PATCH http://localhost:3000/api/v1/tasks/$TASK_ID \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "Content-Type: application/json" \\
  -d '{"is_archived":true}'

# list archived tasks
curl -s -X GET "http://localhost:3000/api/v1/children/$CHILD_ID/tasks?archived=true" \\
  -H "Authorization: Bearer $TOKEN"
```

### curlä¾‹ï¼ˆdaily PUT â†’ GETï¼‰

```bash
# create child
CHILD_ID=$(curl -s -X POST http://localhost:3000/api/v1/children \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "Content-Type: application/json" \\
  -d '{"name":"Taro","grade":"1"}' | jq -r .id)

# create task
TASK_ID=$(curl -s -X POST http://localhost:3000/api/v1/children/$CHILD_ID/tasks \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "Content-Type: application/json" \\
  -d '{"name":"Math Drill","subject":"math","default_minutes":20,"days_mask":62}' | jq -r .id)

# PUT daily
curl -s -X PUT "http://localhost:3000/api/v1/children/$CHILD_ID/daily?date=2026-01-25" \\
  -H "Authorization: Bearer $TOKEN" \\
  -H "Content-Type: application/json" \\
  -d '{"items":[{"task_id":"'"$TASK_ID"'","minutes":20}]}'

# GET daily
curl -s -X GET "http://localhost:3000/api/v1/children/$CHILD_ID/daily?date=2026-01-25" \\
  -H "Authorization: Bearer $TOKEN"
```

### curlä¾‹ï¼ˆdaily-viewï¼‰

```bash
curl -s -X GET "http://localhost:3000/api/v1/children/$CHILD_ID/daily-view?date=2026-01-25" \\
  -H "Authorization: Bearer $TOKEN"
```

### curlä¾‹ï¼ˆcalendar-summaryï¼‰

```bash
curl -s -X GET "http://localhost:3000/api/v1/children/$CHILD_ID/calendar-summary?from=2026-01-01&to=2026-01-31" \\
  -H "Authorization: Bearer $TOKEN"
```

### calendar status å®šç¾©

- white: æœªæ¥æ—¥ or å¯¾è±¡ã‚¿ã‚¹ã‚¯ãªã—
- green: å®Œäº† = å…¨ã‚¿ã‚¹ã‚¯
- yellow: ä¸€éƒ¨å®Œäº†
- red: æœªå®Œäº†

### curlä¾‹ï¼ˆsummaryï¼‰

```bash
# 1é€±é–“
curl -s -X GET "http://localhost:3000/api/v1/children/$CHILD_ID/summary?from=2026-01-01&to=2026-01-07" \\
  -H "Authorization: Bearer $TOKEN"

# 1ãƒ¶æœˆ
curl -s -X GET "http://localhost:3000/api/v1/children/$CHILD_ID/summary?from=2026-01-01&to=2026-01-31" \\
  -H "Authorization: Bearer $TOKEN"
```

---

## OAuthï¼ˆGoogle/GitHubï¼‰

### ç’°å¢ƒå¤‰æ•°

- `FRONTEND_URL` (ä¾‹: `http://localhost:3001`)
- `OAUTH_REDIRECT_BASE_URL` (ä¾‹: `http://localhost:3000`)
- `GOOGLE_CLIENT_ID`
- `GOOGLE_CLIENT_SECRET`
- `GITHUB_CLIENT_ID`
- `GITHUB_CLIENT_SECRET`

### å‹•ä½œç¢ºèª

1) èªè¨¼é–‹å§‹ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹ï¼‰

- `http://localhost:3000/api/v1/auth/oauth/google/start`
- `http://localhost:3000/api/v1/auth/oauth/github/start`

2) èªè¨¼å¾Œã€`FRONTEND_URL/login/callback?token=...` ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ã“ã¨

3) å—ã‘å–ã£ãŸ token ã§ API ãŒä½¿ãˆã‚‹ã“ã¨

```bash
curl -s -X GET http://localhost:3000/api/v1/children \\
  -H "Authorization: Bearer $TOKEN"
```

4) OAuth ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã¯ users ã« display_name / avatar_url / provider ãŒä¿å­˜ã•ã‚Œã‚‹

### /me

ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’å–å¾—ã—ã¾ã™ã€‚

```bash
curl -s -X GET http://localhost:3000/api/v1/me \\
  -H "Authorization: Bearer $TOKEN"
```

ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹:

```json
{
  "user": {
    "id": "uuid",
    "email": "demo@example.com",
    "display_name": "Taro Yamada",
    "avatar_url": "https://...",
    "provider": "google"
  }
}
```
